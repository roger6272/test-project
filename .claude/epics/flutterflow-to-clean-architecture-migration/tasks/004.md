---
epic: flutterflow-to-clean-architecture-migration
status: backlog
priority: P0
estimate: 2-3 hours
depends_on: [001]
week: 1
---

# Task 004: Add Required Dependencies to pubspec.yaml

## Description

Update `pubspec.yaml` with all required packages for clean architecture migration. This includes BLoC, functional programming (dartz), testing utilities, charting, and Firebase monitoring packages.

## Acceptance Criteria

- [ ] All required dependencies added to `pubspec.yaml`
- [ ] All dev dependencies added
- [ ] `flutter pub get` runs successfully
- [ ] No version conflicts
- [ ] App builds successfully with new dependencies

## Technical Details

**Add to dependencies section**:
```yaml
dependencies:
  # Existing (verify versions)
  flutter:
    sdk: flutter
  firebase_core: ^2.20.0
  cloud_firestore: ^4.13.0
  firebase_auth: ^4.14.0
  flutter_blue_plus: ^1.32.0
  go_router: ^13.0.0
  get_it: ^7.6.0
  shared_preferences: ^2.2.0

  # NEW - State Management & Architecture
  flutter_bloc: ^8.1.3
  equatable: ^2.0.5
  dartz: ^0.10.1
  injectable: ^2.3.0

  # NEW - Charts
  fl_chart: ^0.66.0

  # NEW - Firebase Monitoring
  firebase_crashlytics: ^3.4.0
  firebase_analytics: ^10.7.0
  firebase_performance: ^0.9.3

  # NEW - Privacy Policy Viewer
  markdown_widget: ^2.3.0

  # NEW - JSON Serialization
  json_annotation: ^4.8.0
```

**Add to dev_dependencies section**:
```yaml
dev_dependencies:
  flutter_test:
    sdk: flutter

  # NEW - Testing
  mocktail: ^1.0.1
  bloc_test: ^9.1.4

  # NEW - Code Generation
  build_runner: ^2.4.0
  injectable_generator: ^2.4.0
  json_serializable: ^6.7.0

  # Existing
  flutter_lints: ^3.0.0
```

**Commands to run**:
```bash
# Clean previous build
flutter clean

# Get dependencies
flutter pub get

# Verify no conflicts
flutter pub outdated

# Test build
flutter build apk --debug
```

## Dependencies

- Task 001: Folder structure must exist

## Testing

- [ ] Run `flutter pub get` - should complete without errors
- [ ] Run `flutter pub outdated` - verify no major version issues
- [ ] Run `flutter analyze` - should have no new critical errors
- [ ] Build app: `flutter build apk --debug` - should succeed
- [ ] Run app on device/emulator - should launch without crashing

## Notes

- Some FlutterFlow dependencies can remain for now (will remove in Week 8)
- If version conflicts occur, use compatible versions
- Firebase packages should match existing Firebase SDK version
- `flutter_bloc` 8.1.3 is compatible with Dart 3.0+
- Dartz 0.10.1 is the latest stable version for Either types

## Troubleshooting

If version conflicts occur:
1. Check Flutter version: `flutter --version` (should be 3.0+)
2. Update Flutter: `flutter upgrade`
3. Try compatible version ranges instead of exact versions
4. Check pub.dev for compatibility matrices
